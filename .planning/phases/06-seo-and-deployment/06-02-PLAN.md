---
phase: 06-seo-and-deployment
plan: 02
type: execute
wave: 2
depends_on: [06-01]
files_modified:
  - vercel.json
  - .env.local
autonomous: false

must_haves:
  truths:
    - "Site is accessible via HTTPS at Vercel-provided domain"
    - "Convex backend is deployed to production environment"
    - "WorkOS authentication works in production"
    - "Pushing to main branch triggers automatic deployment"
    - "Environment variables are configured in Vercel dashboard"
  artifacts:
    - path: "vercel.json"
      provides: "Vercel build configuration"
      contains: "buildCommand"
      min_lines: 5
  key_links:
    - from: "Vercel deployment"
      to: "Convex production backend"
      via: "CONVEX_DEPLOY_KEY environment variable"
      pattern: "Build command: npx convex deploy"
    - from: "Next.js app"
      to: "WorkOS AuthKit"
      via: "WORKOS_API_KEY and WORKOS_CLIENT_ID"
      pattern: "Environment variables"

user_setup:
  - service: vercel
    why: "Production hosting and automatic deployments"
    steps:
      - task: "Create Vercel account and install Vercel CLI"
        instructions: "Visit https://vercel.com/signup, create account, run: npm install -g vercel"
      - task: "Link project to Vercel"
        instructions: "Run: vercel link (follow prompts to create new project or link existing)"
  - service: convex
    why: "Production backend deployment"
    env_vars:
      - name: CONVEX_DEPLOY_KEY
        source: "Convex Dashboard -> Settings -> Deploy Keys -> Create Production Deploy Key"
        environment: "Production"
    steps:
      - task: "Generate production deploy key"
        location: "Convex Dashboard -> Settings -> Deploy Keys"
        instructions: "Click 'Create Deploy Key', select 'Production' environment, copy key"
  - service: workos
    why: "Production authentication"
    env_vars:
      - name: WORKOS_API_KEY
        source: "WorkOS Dashboard -> API Keys"
      - name: WORKOS_CLIENT_ID
        source: "WorkOS Dashboard -> Configuration"
      - name: NEXT_PUBLIC_WORKOS_REDIRECT_URI
        source: "Set to: https://YOUR-VERCEL-URL.vercel.app/auth/callback"
    dashboard_config:
      - task: "Add production redirect URI"
        location: "WorkOS Dashboard -> Redirects"
        instructions: "Add your Vercel deployment URL redirect: https://YOUR-VERCEL-URL.vercel.app/auth/callback"
---

<objective>
Deploy site to Vercel production with Convex backend integration, configure all environment variables for WorkOS authentication, and set up automatic deployments from main branch.

Purpose: Make site live and accessible to public, enable production authentication, establish continuous deployment pipeline.

Output: Site deployed at Vercel URL with working authentication, automatic deployments configured, all environment variables set.
</objective>

<execution_context>
@D:\Projects\saad-portfolio\.claude\get-shit-done\workflows\execute-plan.md
@D:\Projects\saad-portfolio\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@D:\Projects\saad-portfolio\.planning\PROJECT.md
@D:\Projects\saad-portfolio\.planning\ROADMAP.md
@D:\Projects\saad-portfolio\.planning\STATE.md
@D:\Projects\saad-portfolio\.planning\phases\06-seo-and-deployment\06-RESEARCH.md
@D:\Projects\saad-portfolio\.planning\phases\06-seo-and-deployment\06-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Create Vercel configuration and deploy to production</name>
  <files>vercel.json</files>
  <action>
1. Create vercel.json in project root with build configuration:
   ```json
   {
     "buildCommand": "npx convex deploy --cmd 'npm run build'",
     "installCommand": "npm install",
     "framework": "nextjs"
   }
   ```
   This overrides Vercel's default build to deploy Convex backend BEFORE frontend build, ensuring CONVEX_URL is available during Next.js build.

2. Run vercel CLI to deploy:
   - Run: `vercel --prod`
   - Follow prompts to confirm production deployment
   - CLI will detect Next.js, install dependencies, run build command
   - Note the deployed URL (https://project-name.vercel.app or similar)

IMPORTANT: This deployment will partially fail because environment variables are not yet configured. This is expected - we'll configure them in next task and redeploy.

3. Commit vercel.json:
   ```bash
   git add vercel.json
   git commit -m "chore: add Vercel build configuration for Convex integration"
   ```
  </action>
  <verify>
Run: vercel --prod
Check that Vercel CLI completes deployment (may have runtime errors due to missing env vars)
Visit Vercel dashboard to confirm project exists
  </verify>
  <done>
vercel.json exists with Convex-integrated build command
Initial deployment completed to Vercel (even if not fully functional yet)
Vercel project is linked to repository
  </done>
</task>

<task type="checkpoint:human-action" gate="blocking">
  <action>Configure production environment variables and add redirect URI</action>
  <instructions>
**Required actions (cannot be automated - requires dashboard access):**

1. **Configure Convex Production Deploy Key:**
   - Visit Convex Dashboard: https://dashboard.convex.dev
   - Navigate to your project -> Settings -> Deploy Keys
   - Click "Create Deploy Key"
   - Select "Production" environment
   - Copy the generated deploy key
   - Go to Vercel Dashboard -> Project -> Settings -> Environment Variables
   - Add: `CONVEX_DEPLOY_KEY` = [paste key]
   - Environment: **Production only**

2. **Configure WorkOS Environment Variables:**
   - Visit WorkOS Dashboard: https://dashboard.workos.com
   - Navigate to API Keys section
   - Copy `WORKOS_API_KEY` and `WORKOS_CLIENT_ID`
   - Go to Vercel Dashboard -> Project -> Settings -> Environment Variables
   - Add: `WORKOS_API_KEY` = [paste key], Environment: **Production only**
   - Add: `WORKOS_CLIENT_ID` = [paste client ID], Environment: **Production only**
   - Get your Vercel deployment URL from previous task output
   - Add: `NEXT_PUBLIC_WORKOS_REDIRECT_URI` = `https://YOUR-VERCEL-URL.vercel.app/auth/callback`, Environment: **Production only**

3. **Configure WorkOS Redirect URI:**
   - In WorkOS Dashboard -> Redirects section
   - Add redirect URI: `https://YOUR-VERCEL-URL.vercel.app/auth/callback`
   - Save configuration

4. **Update placeholder domain in metadata:**
   - Replace all instances of 'https://yourdomain.com' in metadata with actual Vercel URL
   - Files to update: app/layout.tsx, app/page.tsx, app/about/page.tsx, app/resume/page.tsx, app/projects/page.tsx, app/stack/page.tsx, app/contact/page.tsx, app/projects/[slug]/page.tsx, app/sitemap.ts, app/robots.ts
   - Commit changes: `git commit -am "chore: update metadata URLs to production domain"`
   - Push to trigger redeploy: `git push origin main`

**Verification checklist:**
- [ ] CONVEX_DEPLOY_KEY added to Vercel (Production only)
- [ ] WORKOS_API_KEY added to Vercel (Production only)
- [ ] WORKOS_CLIENT_ID added to Vercel (Production only)
- [ ] NEXT_PUBLIC_WORKOS_REDIRECT_URI added to Vercel (Production only)
- [ ] WorkOS redirect URI configured for Vercel URL
- [ ] Metadata URLs updated to production domain
- [ ] Changes committed and pushed to main

After completing these steps, Vercel will automatically redeploy with correct environment variables.
  </instructions>
  <resume-signal>Type "configured" when environment variables are set and deployment is redeploying</resume-signal>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Production deployment with Convex backend, WorkOS authentication, and SEO metadata</what-built>
  <how-to-verify>
1. **Verify deployment succeeded:**
   - Visit Vercel Dashboard -> Deployments
   - Check that latest deployment shows "Ready" status
   - Note the production URL

2. **Test public pages:**
   - Visit https://YOUR-VERCEL-URL.vercel.app
   - Verify home page loads with content
   - Check browser tab shows "Portfolio" title
   - Navigate to /about, /resume, /projects, /stack, /contact
   - Verify each page loads and has appropriate title

3. **Test SEO metadata:**
   - View page source on any public page
   - Verify <meta name="description"> tag exists
   - Verify <meta property="og:title"> and og:description tags exist
   - Visit https://YOUR-VERCEL-URL.vercel.app/sitemap.xml
   - Verify XML shows all pages
   - Visit https://YOUR-VERCEL-URL.vercel.app/robots.txt
   - Verify disallow rules for /admin/, /auth/, /api/

4. **Test authentication:**
   - Visit https://YOUR-VERCEL-URL.vercel.app/admin
   - Verify redirects to WorkOS login page
   - Log in with allowlisted email
   - Verify redirects to admin dashboard
   - Verify admin panel functions (view projects, resume data)

5. **Test Convex backend:**
   - In admin panel, verify dashboard shows stats
   - Check that projects list loads
   - Verify resume page shows data (or placeholder if not yet added)

6. **Test automatic deployment:**
   - Make a small change locally (e.g., update a page title)
   - Commit and push to main: `git commit -am "test: verify auto-deploy" && git push origin main`
   - Visit Vercel Dashboard -> Deployments
   - Verify new deployment triggered automatically
   - Wait for deployment to complete
   - Verify change is visible on production site

**Expected results:**
- All public pages load with correct titles and metadata
- Authentication works (login -> admin panel)
- Convex data displays correctly
- Sitemap and robots.txt accessible
- Push to main triggers automatic deployment
  </how-to-verify>
  <resume-signal>Type "approved" if all verification steps pass, or describe issues if any problems found</resume-signal>
</task>

</tasks>

<verification>
## Production Deployment Checklist
- Site accessible at Vercel-provided HTTPS URL
- All public pages render correctly
- Metadata visible in page source and browser tabs
- sitemap.xml and robots.txt accessible
- WorkOS authentication redirects work
- Admin panel loads after login
- Convex backend serves data correctly
- Push to main triggers automatic deployment

## Environment Variables Confirmed
- CONVEX_DEPLOY_KEY set to Production environment only
- WORKOS_API_KEY set to Production environment only
- WORKOS_CLIENT_ID set to Production environment only
- NEXT_PUBLIC_WORKOS_REDIRECT_URI points to Vercel URL
- CONVEX_URL automatically set by Convex deploy
</verification>

<success_criteria>
- DEPLOY-01 covered: Site deployed to Vercel with custom domain (Vercel-provided domain)
- DEPLOY-02 covered: Convex backend deployed and connected to production
- DEPLOY-03 covered: All environment variables configured
- DEPLOY-04 covered: Automatic deployment on push to main works
- Site is publicly accessible via HTTPS
- Authentication works in production
- All public pages have working metadata
- Convex backend serves data to production frontend
</success_criteria>

<output>
After completion, create `D:\Projects\saad-portfolio\.planning\phases\06-seo-and-deployment\06-02-SUMMARY.md`
</output>
