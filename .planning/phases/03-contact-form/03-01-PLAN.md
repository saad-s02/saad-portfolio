---
phase: 03-contact-form
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - lib/validations/contact.ts
  - components/contact/ContactForm.tsx
  - app/contact/page.tsx
  - app/layout.tsx
autonomous: true

must_haves:
  truths:
    - Visitor can see contact form with name, email, and message fields
    - Visitor sees validation errors for invalid input
    - Form shows loading state during submission
    - Form is accessible with proper labels and ARIA attributes
  artifacts:
    - path: lib/validations/contact.ts
      provides: Zod schema for contact form validation
      exports: [contactFormSchema, ContactFormData]
    - path: components/contact/ContactForm.tsx
      provides: Client component with React Hook Form integration
      min_lines: 80
    - path: app/contact/page.tsx
      provides: Contact page with form and email fallback
      min_lines: 20
    - path: app/layout.tsx
      provides: Toast notification provider setup
      contains: Toaster
  key_links:
    - from: components/contact/ContactForm.tsx
      to: lib/validations/contact.ts
      via: import contactFormSchema
      pattern: "zodResolver\\(contactFormSchema\\)"
    - from: components/contact/ContactForm.tsx
      to: react-hook-form
      via: useForm hook
      pattern: "useForm<ContactFormData>"
    - from: app/layout.tsx
      to: react-hot-toast
      via: Toaster component
      pattern: "<Toaster"
---

<objective>
Create contact form UI with client-side validation and accessibility features.

Purpose: Enable visitors to contact the site owner through a validated form with proper UX feedback. This plan focuses on the frontend form structure and validation, preparing for backend integration in Plan 02.

Output: Working contact form UI that validates input and shows errors, with toast notification infrastructure ready for submission feedback.
</objective>

<execution_context>
@D:\Projects\saad-portfolio\.claude\get-shit-done\workflows\execute-plan.md
@D:\Projects\saad-portfolio\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@D:\Projects\saad-portfolio\.planning\PROJECT.md
@D:\Projects\saad-portfolio\.planning\ROADMAP.md
@D:\Projects\saad-portfolio\.planning\STATE.md
@D:\Projects\saad-portfolio\.planning\REQUIREMENTS.md
@D:\Projects\saad-portfolio\.planning\phases\03-contact-form\03-RESEARCH.md

# Codebase context
@D:\Projects\saad-portfolio\convex\schema.ts
@D:\Projects\saad-portfolio\app\layout.tsx
@D:\Projects\saad-portfolio\package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install form libraries and create validation schema</name>
  <files>
    package.json
    lib/validations/contact.ts
  </files>
  <action>
1. Install required dependencies:
   ```bash
   npm install react-hook-form zod @hookform/resolvers react-hot-toast
   ```

2. Create `lib/validations/contact.ts` with Zod schema:
   - Export `contactFormSchema` with fields:
     - `name`: string, min 2 chars, max 50 chars, with error messages
     - `email`: string with .email() validation, clear error message
     - `message`: string, min 10 chars, max 1000 chars, with error messages
     - `website`: string, max 0 chars, optional (honeypot field)
   - Export type `ContactFormData = z.infer<typeof contactFormSchema>`
   - Use descriptive error messages for good UX (e.g., "Please enter a valid email address")

**Why separate validation file:** This schema will be used by both the client form (React Hook Form) and server mutation (Convex) in Plan 02, preventing client/server validation drift.
  </action>
  <verify>
```bash
npm list react-hook-form zod @hookform/resolvers react-hot-toast
cat lib/validations/contact.ts
```
Should show all dependencies installed and schema file with 4 exported fields.
  </verify>
  <done>
- react-hook-form, zod, @hookform/resolvers, react-hot-toast appear in package.json dependencies
- lib/validations/contact.ts exists with contactFormSchema and ContactFormData type
- Schema includes name/email/message validation with user-friendly error messages
- Honeypot field (website) is present with max(0) validation
  </done>
</task>

<task type="auto">
  <name>Task 2: Build ContactForm client component with React Hook Form</name>
  <files>
    components/contact/ContactForm.tsx
  </files>
  <action>
Create `components/contact/ContactForm.tsx` as a "use client" component:

1. **Setup and imports:**
   - Mark as "use client"
   - Import useForm from react-hook-form
   - Import zodResolver from @hookform/resolvers/zod
   - Import contactFormSchema and ContactFormData from lib/validations/contact
   - Import toast from react-hot-toast

2. **Form setup with useForm:**
   - Configure with zodResolver(contactFormSchema)
   - Provide defaultValues for all fields: name "", email "", message "", website ""
   - CRITICAL: Always include defaultValues to prevent form reset bugs and dirty state issues
   - Extract register, handleSubmit, formState (errors, isSubmitting), reset from useForm

3. **onSubmit handler (stub for now):**
   - Make async function that accepts ContactFormData
   - Log form data to console (Plan 02 will replace with Convex mutation)
   - Show success toast: `toast.success("Message sent successfully!")`
   - Call `reset()` to clear form
   - Add try/catch for error handling (shows toast on error)

4. **Render form fields:**
   - **Honeypot field first** (hidden from users):
     - Use `{...register("website")}` for field binding
     - Set type="text", tabIndex={-1}, autoComplete="off"
     - Apply inline style: `{ opacity: 0, position: "absolute", top: 0, left: 0, height: 0, width: 0, zIndex: -1 }`
     - DO NOT use display:none (bots can detect this) - use opacity and positioning instead

   - **Name field:**
     - Label with htmlFor="name", mark as required visually
     - Input with id="name", {...register("name")}
     - Set disabled={isSubmitting}
     - Add aria-invalid={errors.name ? "true" : "false"}
     - Add aria-describedby={errors.name ? "name-error" : undefined}
     - Show error message if errors.name exists, with id="name-error" and role="alert"

   - **Email field:**
     - Same pattern as name field
     - Use type="email" for browser validation hint
     - id="email", {...register("email")}

   - **Message field:**
     - Use textarea instead of input
     - rows={6} for better UX
     - Same accessibility pattern: aria-invalid, aria-describedby, role="alert" on error

   - **Submit button:**
     - type="submit"
     - disabled={isSubmitting}
     - Show "Sending..." when isSubmitting is true, "Send Message" otherwise

5. **Styling:**
   - Use dark theme Tailwind classes matching existing site aesthetic
   - Form fields: dark background (bg-gray-900), light text, border (border-gray-700)
   - Focus states: ring-2 ring-blue-500
   - Error text: text-red-400
   - Button: bg-blue-600 hover:bg-blue-700, disabled:opacity-50 disabled:cursor-not-allowed
   - Spacing: space-y-6 for form, space-y-2 for field groups

**Why React Hook Form:** Uncontrolled inputs reduce re-renders, best performance in React ecosystem. zodResolver provides type-safe validation that matches server-side schema.

**Why inline styles for honeypot:** Some bots detect CSS classes; inline styles are harder to parse programmatically.
  </action>
  <verify>
```bash
cat components/contact/ContactForm.tsx
```
Should show:
- "use client" directive at top
- useForm configured with zodResolver(contactFormSchema)
- defaultValues provided for all 4 fields
- Honeypot field with opacity:0 styling (not display:none)
- All visible fields have proper labels, ARIA attributes, and error display
- Submit button shows loading state
  </verify>
  <done>
- components/contact/ContactForm.tsx exists with "use client" directive
- Form uses React Hook Form with zodResolver integration
- All fields (name, email, message, website) registered with proper validation
- Honeypot field is hidden using opacity and absolute positioning (not display:none)
- Accessible form with aria-invalid, aria-describedby, role="alert" attributes
- Submit button disabled during submission with loading text
- Error messages display validation feedback from Zod schema
  </done>
</task>

<task type="auto">
  <name>Task 3: Create contact page and add toast provider to layout</name>
  <files>
    app/contact/page.tsx
    app/layout.tsx
  </files>
  <action>
1. **Create `app/contact/page.tsx` as Server Component:**
   - Import ContactForm from @/components/contact/ContactForm
   - Render page structure:
     - Heading: "Get in Touch"
     - Subheading explaining purpose (e.g., "Have a question or want to work together? Send me a message.")
     - ContactForm component
     - Email fallback section below form:
       - Text: "Prefer email?"
       - mailto link: "saad@example.com" (placeholder, will be updated later)
       - Style link with text-blue-400 hover:text-blue-300
   - Use consistent spacing and dark theme styling
   - Metadata: title "Contact", description "Get in touch with me"

2. **Update `app/layout.tsx` to add Toaster:**
   - Import Toaster from react-hot-toast
   - Add `<Toaster />` component inside ConvexClientProvider, after {children}
   - Configure Toaster with:
     - position="bottom-right"
     - toastOptions with duration: 4000
     - Style for dark theme: background '#1f2937' (gray-800), color '#f9fafb' (gray-50)
   - This makes toasts appear consistently styled across the app

**Why Server Component for page:** Contact page wrapper doesn't need client state. Only ContactForm needs "use client" for form interactivity.

**Why bottom-right toast position:** Doesn't interfere with form content, consistent with modern UX patterns.
  </action>
  <verify>
```bash
cat app/contact/page.tsx
cat app/layout.tsx | grep -A 10 "Toaster"
npm run build
```
Build should succeed. Layout should show Toaster with dark theme config.
  </verify>
  <done>
- app/contact/page.tsx exists with heading, ContactForm component, and email fallback link
- Metadata includes title and description for SEO
- app/layout.tsx includes Toaster component with dark theme styling
- Toaster configured for bottom-right position with 4-second duration
- Build succeeds without TypeScript or import errors
- CONTACT-01 requirement satisfied: Contact form with name, email, message fields visible
- CONTACT-06 requirement satisfied: Email fallback link visible
  </done>
</task>

</tasks>

<verification>
1. **Visual check:** Visit http://localhost:3000/contact and see form with 3 visible fields (name, email, message) and submit button
2. **Validation check:** Try submitting empty form - should see error messages for each field
3. **Honeypot check:** Inspect DOM - website field should be present but invisible (opacity:0)
4. **Accessibility check:** Use keyboard to navigate form - labels should be announced, errors should be readable
5. **Loading state check:** Submit valid data - button should show "Sending..." and disable during submission
6. **Toast check:** After submission, should see success toast in bottom-right corner
7. **Form reset check:** After successful submit, form fields should clear to empty state
</verification>

<success_criteria>
- [ ] react-hook-form, zod, @hookform/resolvers, react-hot-toast installed in package.json
- [ ] lib/validations/contact.ts exports contactFormSchema with name/email/message/website validation
- [ ] components/contact/ContactForm.tsx uses React Hook Form with zodResolver
- [ ] Honeypot field (website) is hidden with opacity:0, not display:none
- [ ] All form fields have proper labels, ARIA attributes (aria-invalid, aria-describedby, role="alert")
- [ ] Submit button shows loading state (disabled + "Sending..." text) during submission
- [ ] app/contact/page.tsx renders ContactForm with heading and email fallback link
- [ ] app/layout.tsx includes Toaster with dark theme configuration
- [ ] Form validates input and displays user-friendly error messages
- [ ] Form shows success toast and resets after submission (stub mutation for now)
- [ ] Build succeeds with no TypeScript errors
- [ ] Requirements CONTACT-01 and CONTACT-06 partially satisfied (UI only, backend in Plan 02)
</success_criteria>

<output>
After completion, create `.planning/phases/03-contact-form/03-01-SUMMARY.md` documenting:
- Dependencies installed and versions
- Validation schema structure
- Component architecture (Server Component page wrapper + Client Component form)
- Accessibility features implemented
- What's stubbed for Plan 02 (Convex mutation integration)
</output>
